"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FirebaseOrder=void 0;var FirebaseOrder={template:"",data:function(){return{searchText:"",isEdit:!1,products:[],order:{id:""},orders:[],sort:"id",isAsc:!0,currentPage:1,pageSize:2,showDetailList:[]}},beforeCreate:function(){},created:function(){console.log("created"),this.getOrders(),this.getProducts()},computed:{ordersFilter:function(){var t=this.pageSize*(this.currentPage-1),e=t+this.pageSize;return this.searchOrdersByAll(this.searchText).slice(t,e)}},methods:{getOrders:function(){var e=this;db.collection("orders").orderBy("id").get().then(function(t){e.orders=t.docs.map(function(t){return t.data()})})},getProducts:function(){var e=this;db.collection("products").orderBy("id").get().then(function(t){e.products=t.docs.map(function(t){return t.data()})})},getOrderProducts:function(e){return this.products.filter(function(t){return e.includes(t.id)})},getOrderSum:function(t){var e=0;for(var r in this.products)t.includes(this.products[r].id)&&(e+=Number(this.products[r].price));return e},searchOrdersByAll:function(r){return this.orders.filter(function(t){for(var e in t)if(String(t[e]).toLowerCase().includes(r.toLowerCase()))return t})},addProduct:function(e){var r=this;db.collection("products").orderBy("id","desc").limit(1).get().then(function(t){t.forEach(function(t){e.id=String(Number(t.data().id)+1),r.products.push(_.cloneDeep(e)),db.collection("products").add(e)})})},removeProduct:function(t){this.products.splice(this.products.indexOf(t),1),db.collection("products").where("id","==",t.id).get().then(function(t){t.forEach(function(t){t.ref.delete()})})},editProducts:function(t){var e=this,r=db.batch(),i=0;db.collection("products").orderBy(this.sort).get().then(function(t){t.forEach(function(t){r.set(t.ref,e.products[i]),i++}),r.commit().then(function(){return console.log("batch commit success(editProducts)")}).catch(function(t){return console.log("error",t)})})},sortProducts:function(t){this.sort=t,this.isAsc=!this.isAsc;var r=this.sort,i=this.isAsc;this.products=this.products.sort(function(t,e){return i?t[r]>e[r]?1:-1:t[r]<e[r]?1:-1})},totalPage:function(){return Math.ceil(this.searchOrdersByAll(this.searchText).length/this.pageSize)},toggleDetail:function(t){Vue.set(this.showDetailList,t,!this.showDetailList[t])},isShowDetail:function(t){return this.showDetailList[t]}}};exports.FirebaseOrder=FirebaseOrder;